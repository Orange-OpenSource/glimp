<project name="Build" default="compress">
    <target name="concatenate">
        <concat destfile="../glimp.js" encoding="UTF-8" outputencoding="UTF-8" fixlastline="true">
            <filelist id="filelist" dir="../src">
                <file name="glimp.js"/>
                <file name="glimp_canvas.js"/>
                <file name="glimp_frame.js"/>
                <file name="glimp_filter.js"/>
                <file name="glimp_bgfg.js"/>                
                <file name="glimp_haar.js"/>     
                <file name="glimp_export.js"/>
            </filelist>
            <filelist id="filters" dir="../src/filters">
                <file name="skin.js"/>
                <file name="convolution.js"/>
                <file name="mix.js"/>
                <file name="colormask.js"/>
                <file name="erode.js"/>
                <file name="dilate.js"/>
                <file name="binary.js"/>
                <file name="bborder.js"/>
                <file name="threshold.js"/>
                <file name="grayscale.js"/>
                <file name="integral.js"/>
            </filelist>
            <filelist id="converters" dir="../src/converters">
                <file name="rgb2hsv.js"/>
                <file name="pack.js"/>
                <file name="unpack.js"/>
            </filelist>
            <filelist id="bgfg" dir="../src/bgfg">
                <file name="basic.js"/>
                <file name="average.js"/>
                <file name="gaussian.js"/>
            </filelist>
        </concat>
    </target>
    <target name="compress" depends="concatenate" description="Compress glimp.js to glimp-min.js">
        <apply executable="java" parallel="false">
            <filelist dir="../" files="glimp.js" />
            <arg line="-jar" />
            <arg path="yuicompressor-2.4.2.jar" />
            <srcfile />
            <arg line="-o" />
            <mapper type="glob" from="*.js" to="../*-min.js" />
            <targetfile />
        </apply>
    </target>
</project>
